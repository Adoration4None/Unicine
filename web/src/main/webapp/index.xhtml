<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<ui:composition template="WEB-INF/template.xhtml">
    <ui:define name="title">Inicio</ui:define>

    <ui:define name="header">
        <nav>
            <div jsf:id="navegacion-inicio" class="#{seguridadBean.ciudadSeleccionada != null ? 'oculto' : 'navegacion'}">
                <div class="container">
                    <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
                        <ul class="nav col-12 col-lg-auto me-lg-auto justify-content-center">
                            <li>
                                <a href="/" class="nav-link px-2 link-dark">
                                    <h:graphicImage library="img" name="logo2.png" styleClass="img-logo" />
                                </a>
                            </li>
                        </ul>

                        <ul class="nav col-12 col-lg-auto justify-content-center">
                            <li class="mx-1 my-1"> <p:commandButton rendered="#{!seguridadBean.autenticado}" style="background: transparent; border: transparent; color: #6B8CE1" onclick="PF('registro').show()" value="Registrarse"/> </li>
                            <li class="mx-1 my-1"> <p:commandButton rendered="#{!seguridadBean.autenticado}" style="background: transparent; border: transparent; color: #6B8CE1" onclick="PF('login').show()" value="Iniciar Sesion"/> </li>
                            <li class="mx-1 my-1"> <h:outputLabel rendered="#{seguridadBean.autenticado}" style="color: #6B8CE1;" value="#{seguridadBean.personaIngresada.nombreCompleto}" /> </li>
                        </ul>

                        <h:form rendered="#{seguridadBean.autenticado}">
                            <div class="dropdown text-end mx-3 my-1">
                                <a href="#" class="d-block link-dark text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                    <img src="https://github.com/mdo.png" alt="mdo" width="32" height="32" class="rounded-circle" />
                                </a>
                                <ul class="dropdown-menu text-small dropdown-menu-dark gap-1 p-2 rounded-3 mx-0 border-0 shadow w-220px" style="background: rgba(10, 8, 20, 0.9);">
                                    <li><a class="dropdown-item d-flex gap-2 align-items-center" href="#">Informacion del usuario</a></li>
                                    <li><a class="dropdown-item" href="#">Historial de compras</a></li>
                                    <li><a class="dropdown-item" href="#">Ver y agregar cupones</a></li>
                                    <li><hr class="dropdown-divider" /></li>
                                    <li><a class="dropdown-item" href="#"> <i class="pi pi-power-off" /> Cerrar sesion</a></li>
                                </ul>
                            </div>
                        </h:form>
                    </div>

                </div>
            </div>

            <div jsf:id="navegacion" class="#{seguridadBean.ciudadSeleccionada == null ? 'oculto' : 'navegacion'}">
                <div class="container-fluid">
                    <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start mx-lg-5">
                        <ul class="nav col-12 col-lg-auto me-auto justify-content-center align-items-center">
                            <li>
                                <a href="/" class="nav-link px-2 link-dark">
                                    <h:graphicImage library="img" name="logo2.png" styleClass="img-logo" />
                                </a>
                            </li>
                            <li class="mx-1 my-1 align-items-center">
                                #{principalBean.nombreCiudad}
                            </li>
                        </ul>

                        <h:form styleClass="w-50 ms-auto me-0">
                            <div role="search">
                                <!--  aqui no me funciono ponerle el tamaño usando la clase -->
                                <p:inputText styleClass="mx-2" style="background: #1B1632; border-radius: 20px; border: transparent; width: 50%;"
                                             placeholder="¿Que pelicula estas buscando?" required="true" value="#{buscarPeliculaBean.busqueda}"/>

                                <p:commandButton style="border-radius: 50%; background-color: transparent;" update="@form"
                                                 icon="pi pi-chevron-right" action="#{buscarPeliculaBean.buscarPelicula}">
                                </p:commandButton>
                            </div>
                        </h:form>

                        <ul class="nav col-12 col-lg-auto justify-content-center">
                            <li class="mx-1 my-1"> <p:commandButton rendered="#{!seguridadBean.autenticado}" style="background: transparent; border: transparent; color: #6B8CE1" onclick="PF('registro').show()" value="Registrarse"/> </li>
                            <li class="mx-1 my-1"> <p:commandButton rendered="#{!seguridadBean.autenticado}" style="background: transparent; border: transparent; color: #6B8CE1" onclick="PF('login').show()" value="Iniciar Sesion"/> </li>
                            <li class="mx-1 my-1"> <h:outputLabel rendered="#{seguridadBean.autenticado}" style="color: #6B8CE1;" value="#{seguridadBean.personaIngresada.nombreCompleto}" /> </li>
                        </ul>

                        <h:form rendered="#{seguridadBean.autenticado}">
                            <div class="dropdown text-end mx-3 my-1">
                                <a href="#" class="d-block link-dark text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                    <img src="https://github.com/mdo.png" alt="mdo" width="32" height="32" class="rounded-circle" />
                                </a>
                                <ul class="dropdown-menu text-small dropdown-menu-dark gap-1 p-2 rounded-3 mx-0 border-0 shadow w-220px" style="background: rgba(10, 8, 20, 0.9);">
                                    <li><a class="dropdown-item d-flex gap-2 align-items-center" href="#">Informacion del usuario</a></li>
                                    <li><a class="dropdown-item" href="#">Historial de compras</a></li>
                                    <li><a class="dropdown-item" href="#">Ver y agregar cupones</a></li>
                                    <li><hr class="dropdown-divider" /></li>
                                    <li><a class="dropdown-item" href="#"> <i class="pi pi-power-off" /> Cerrar sesion</a></li>
                                </ul>
                            </div>
                        </h:form>
                    </div>
                </div>
            </div>
        </nav>
    </ui:define>

    <ui:define name="content">
        <div jsf:id="seccion-ciudad" class="#{seguridadBean.ciudadSeleccionada != null ? 'oculto' : 'col-auto align-items-center align-content-center m-3 text-center'}" >

            <h:graphicImage library="img" name="logo.png" styleClass="logo-principal my-0" />

            <h1 class="texto-resaltado">Bienvenido a Unicine</h1>

            <h2 class="texto my-3">¿Donde estas?</h2>
            <div class="elegir-ciudad p-3 m-auto">
                <h:form>
                    <div>
                        <h3 class="texto">Selecciona tu ciudad</h3>

                        <p:selectOneMenu id="seleccion_ciudad" styleClass="mx-2" style="background: #1B1632; border-radius: 20px; border: transparent; width: 80%;" value="#{principalBean.ciudadActual}" required="true" converter="#{ciudadConverter}">
                            <f:selectItem itemLabel="..." noSelectionOption="true" itemValue="#{null}" />
                            <f:selectItems value="#{principalBean.ciudades}" var="ciudad" itemLabel="#{ciudad.nombre}, #{ciudad.departamento}" itemValue="#{ciudad}"/>
                        </p:selectOneMenu>

                        <p:commandButton style="border-radius: 50%; background-color: transparent;" update="@form,seccion-peliculas,seccion-ciudad,navegacion-inicio,navegacion"
                                         icon="pi pi-chevron-right" action="#{seguridadBean.seleccionarCiudad(principalBean.ciudadActual)}">
                            <f:ajax render="seccion-funciones" />
                        </p:commandButton>

                        <p:message for="seleccion_ciudad" showDetail="true"/>
                    </div>
                </h:form>
            </div>

        </div>


        <div jsf:id="imagenes-inicio" class="#{seguridadBean.ciudadSeleccionada  == null ? 'oculto' : ''}">
            <div id="myCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"> </button>
                    <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="1" aria-label="Slide 2"> </button>
                    <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="2" aria-label="Slide 3"> </button>
                </div>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="https://techplanet.today/storage/posts/2022/07/26/97/Q7ewZp0yYuOJGFijwUJRDsFu5BjtFqQ7kItkb8RW.jpg" alt="cover banner" width="100%" height="100%"/>

                        <div class="container">
                            <div class="carousel-caption">
                                <h1 class="titulo">Las peliculas del momento</h1>
                                <p style="text-shadow: 2px 2px 5px black;">¡Explora nuestro catalogo con mas de 5 peliculas para todos los gustos!</p>
                            </div>
                        </div>
                    </div>
                    <p:repeat value="#{principalBean.imagenesPortada}" var="imagen">
                        <div class="carousel-item">
                            <img src="#{imagen}" alt="cover banner" width="100%" height="100%"/>

                            <div class="container">
                                <div class="carousel-caption">
                                    <h1 class="titulo">Unicine te espera</h1>
                                    <p style="text-shadow: 2px 2px 5px black;">Disfruta de experiencias inolvidables en los mejores teatros</p>
                                </div>
                            </div>
                        </div>
                    </p:repeat>

                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"> </span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#myCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"> </span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>

        </div>


        <div jsf:id="seccion-peliculas" class="#{seguridadBean.ciudadSeleccionada  == null || principalBean.teatroSeleccionado == true ? 'oculto' : ''}" >

            <div jsf:id="peliculas" class="container">

                <div class="ms-auto me-0 w-50 my-2 mt-3">
                    <p:outputLabel styleClass="texto-resaltado" for="seleccion_teatro" value="Filtrar por teatro: " />
                    <p:selectOneMenu id="seleccion_teatro" styleClass="mx-3" style="background: #1B1632; border-radius: 20px; border: transparent; width: 60%;"
                                     value="#{principalBean.teatro}" converter="#{teatroConverter}">
                        <f:selectItem itemLabel="..." noSelectionOption="true" itemValue="#{null}" />
                        <f:selectItems value="#{principalBean.teatrosCiudad}" var="teatro" itemLabel="#{teatro.nombre}" itemValue="#{teatro}"/>
                        <p:ajax event="change" listener="#{principalBean.seleccionarTeatro}" update="seccion-peliculas" />
                    </p:selectOneMenu>
                </div>

                <div>
                    <h1 class="titulo my-3 ms-5">En Estreno</h1>
                    <div jsf:id="peliculas-estreno">
                        <p:carousel value="#{principalBean.peliculasEstrenoCiudad}" var="pelicula" numVisible="3" numScroll="3" containerStyleClass="peliculas">
                            <div class="pelicula">

                                <a href="detalle_pelicula.xhtml?city=#{principalBean.idCiudadParam}&amp;mov=#{pelicula.nombre}" class="texto text-decoration-none">
                                    <p:graphicImage styleClass="img-fluid rounded-2 w-75 my-2 shadow-lg" url="https://picfiles.alphacoders.com/166/166769.jpg" />
                                    <h4 class="mb-1">#{pelicula.nombre}</h4>
                                    <h6 class="mt-0 mb-3">#{pelicula.sinopsis}</h6>
                                    <h6 class="mt-0 mb-3">
                                        <p:repeat value="#{pelicula.nombresGeneros}" var="genero">
                                            <p:chip label="#{genero}" styleClass="me-2 text-bg-dark"/>
                                        </p:repeat>
                                    </h6>
                                </a>
                            </div>
                        </p:carousel>
                    </div>
                </div>

                <hr class="my-3 shadow-lg"/>

                <div>
                    <h1 class="titulo my-3 ms-5">Preventa</h1>
                    <div jsf:id="peliculas-preventa">
                        <p:carousel value="#{principalBean.peliculasPreventaCiudad}" var="pelicula" numVisible="3" numScroll="3" containerStyleClass="peliculas">
                            <div class="pelicula mx-2">
                                <a href="detalle_pelicula.xhtml?city=#{principalBean.idCiudadParam}&amp;mov=#{pelicula.nombre}" class="texto text-decoration-none">
                                    <p:graphicImage styleClass="img-fluid rounded-2 w-75 my-2 shadow-lg" url="https://image.tmdb.org/t/p/original/iqR0M1ln7Kobjp9liUj2Q7mtQZG.jpg" />
                                    <h4 class="mb-1">#{pelicula.nombre}</h4>
                                    <h6 class="mt-0 mb-3">#{pelicula.sinopsis}</h6>
                                    <h6 class="mt-0 mb-3">
                                        <p:repeat value="#{pelicula.nombresGeneros}" var="genero">
                                            <p:chip label="#{genero}" styleClass="me-2 text-bg-dark"/>
                                        </p:repeat>
                                    </h6>
                                </a>
                            </div>
                        </p:carousel>
                    </div>
                </div>

            </div>

        </div>

    </ui:define>
</ui:composition>
</html>